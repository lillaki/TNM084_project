<!doctype html>
<html lang="en">
  <head>
    <title>Iris</title>
    <meta charset="utf-8">
    <style>*{box-sizing:border-box; margin:0; padding:0;}</style>
  </head>

  <body>
    <div id="container"></div>
  </body>

  <script src="js/three.min.js"></script>
  <script src="js/OrbitControls.js"></script>


  <!-- VERTEX SHADER -->
  <script type="x-shader/x-vertex" id="vertexShader">
    varying vec2 vUv;
    varying float s;
    varying float t;

    void main() {
        vUv = uv;
        s = uv.x;
        t = uv.y; 
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
  </script>

  <!-- FRAGMENT SHADER -->
  <script type="x-shader/x-vertex" id="fragmentShader">
    varying vec2 vUv;
    varying float s;
    varying float t;

    void main() {
        vec3 whiteColor = vec3(1., 1., 1.).rgb;
        vec3 blackColor = vec3(0., 0., 0.).rbg;
        vec3 irisColor  = mix(vec3( s, t, 0. ), whiteColor, step(t, 0.8));

        gl_FragColor = vec4( mix(blackColor, irisColor, step(t, 0.93)), 1. );
    }
  </script>

  <!-- MAIN CODE -->
  <script type="text/javascript" id="mainCode">

     // VARIABLES
    var container, renderer, scene, camera, controls,
    mesh, start = Date.now(), fov = 30;

    var wireframe, line, linematerial, lights, uniforms;

    // Get shaders by textContent
    var vertexShader = document.getElementById( 'vertexShader' ).textContent;
    var fragmentShader = document.getElementById( 'fragmentShader' ).textContent;

    container = document.getElementById( "container" );

    // RENDERER 
    renderer = new THREE.WebGLRenderer({ antialias:true, aplha: true });
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setPixelRatio( window.devicePixelRatio );
    container.appendChild( renderer.domElement );

    // SCENE AND CAMERA 
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(fov, window.innerWidth / window.innerHeight, 1, 10000 );
    camera.position.z = 100;

    // SPHERE
    geometry = new THREE.IcosahedronGeometry( 15, 5 );
    geometry.rotateX( Math.PI / 2 );

    // MATERIAL
    material = new THREE.ShaderMaterial( {
      vertexShader: vertexShader,
      fragmentShader: fragmentShader,
    } );

    // Mesh for debugging purposes
    mesh = new THREE.Mesh(geometry, material);
    scene.add( mesh );

    // CONTROLS
    controls = new THREE.OrbitControls( camera, renderer.domElement );

    // RENDER WITH THE SHADERS
    render();

    // MESH WIREFRAME
    wireframe = new THREE.WireframeGeometry( geometry );
    linematerial = new THREE.LineBasicMaterial({
      color: 0xffffff
    }); 

    line = new THREE.LineSegments( wireframe, linematerial );
    line.material.depthTest = true;
    line.transparent = false;
    line.material.opacity = 0.25; 
    // scene.add( line );

  // EVENT LISTENER
  onWindowResize();
  window.addEventListener( 'resize', onWindowResize, false );

  function onWindowResize () {
    renderer.setSize( window.innerWidth, window.innerHeight );
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
  }

  function render() {
    renderer.render( scene, camera );
    requestAnimationFrame( render );
  }
  </script>

</html>
